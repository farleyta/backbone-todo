var toDoApp=toDoApp||{};toDoApp.ToDo=Backbone.Model.extend({defaults:{title:"",isComplete:!1},toggle:function(){this.save({isComplete:!this.get("isComplete")})}});var toDoApp=toDoApp||{};toDoApp.ToDoList=Backbone.Collection.extend({model:toDoApp.ToDo,comparator:"orderNum",localStorage:new Backbone.LocalStorage("backbone-todo"),getCompleted:function(){return this.filter(function(toDoModel){return toDoModel.get("isComplete")})},getRemaining:function(){return this.filter(function(toDoModel){return!toDoModel.get("isComplete")})},nextOrderNum:function(){return this.length<1?1:this.max(function(toDoModel){return toDoModel.get("orderNum")}).get("orderNum")+1}});var toDoApp=toDoApp||{};toDoApp.AppView=Backbone.View.extend({el:"#todoapp",statsTemplate:_.template($("#stats-template").html()),initialize:function(){this.todoList=toDoApp.todoList,this.$allCheckbox=this.$("#toggle-all"),this.$input=this.$("#new-todo"),this.$footer=this.$("#footer"),this.$main=this.$("#main"),this.listenTo(this.todoList,"add",this.addToDo),this.listenTo(this.todoList,"reset",this.addAllToDos)},events:{"keypress #new-todo":"createOnEnter","click #clear-completed":"clearCompleted"},addToDo:function(todo){console.log(todo.get("title"))},addAllToDos:function(allToDos){this.$("#todo-list").html(""),allToDos.each(this.addToDo,this)},clearCompleted:function(){_.invoke(this.todoList.getCompleted(),function(){this.destroy({success:function(model){console.log("Model: "+model.get("orderNum")+" successfully destroyed.")},error:function(model,response){console.log("Error: "+response+"\nModel: "+model.get("orderNum")+" successfully destroyed.")}})})},createOnEnter:function(e){13===e.which&&this.$input.val().trim()&&(this.todoList.create(this.newToDoAttrs()),this.$input.val(""))},newToDoAttrs:function(){return{title:this.$input.val(),orderNum:this.todoList.nextOrderNum(),isComplete:!1}}}),toDoApp.todoList=new toDoApp.ToDoList,toDoApp.todoView=new toDoApp.AppView;